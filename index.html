<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8"/>
  <meta name="viewport" content="width=device-width,initial-scale=1"/>
  <title>Cabi Invitation Studio</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <style>
    /* Subtle white-fabric weave background (very light crosshatch) */
    body {
      background:
        repeating-linear-gradient(45deg, rgba(0,0,0,0.022) 0 2px, transparent 2px 10px),
        repeating-linear-gradient(-45deg, rgba(0,0,0,0.018) 0 1px, transparent 1px 9px),
        #ffffff;
      background-attachment: fixed;
    }
    /* Card styling */
    .card {
      background: #ffffff;
      border-radius: 16px;
      border: 1px solid #e5e7eb;
      box-shadow: 0 8px 30px rgba(17, 24, 39, 0.06);
    }
    /* Stitch line wrapper */
    .stitch {
      border: 2px dashed #e5e7eb;
      border-radius: 18px;
    }
    .mono { font-family: ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, "Liberation Mono","Courier New", monospace; }
    .field { background: #fff; }
  </style>
</head>
<body class="text-slate-800">
  <header class="max-w-5xl mx-auto px-4 md:px-6 pt-8 pb-4">
    <div class="flex items-center gap-3">
      <!-- Minimal hanger icon -->
      <svg width="28" height="18" viewBox="0 0 24 24" fill="none"
           stroke="currentColor" stroke-width="1.6" stroke-linecap="round" stroke-linejoin="round"
           class="text-slate-700" aria-hidden="true">
        <path d="M12 3a3 3 0 0 1 3 3c0 1.5-1 2-2.1 2.6-.6.3-.9.8-.9 1.4v.5" />
        <path d="M3.5 18.5 12 13l8.5 5.5" />
        <path d="M4 19h16" />
      </svg>
      <div>
        <h1 class="text-2xl md:text-3xl font-semibold tracking-tight">Cabi Invitation Studio</h1>
        <p class="text-slate-600 mt-1">Type your own tone & collection or pick a suggestion from the same box.</p>
      </div>
    </div>
  </header>

  <main class="max-w-5xl mx-auto px-4 md:px-6 pb-16">
    <div class="stitch p-4 md:p-6">
      <div class="grid md:grid-cols-2 gap-6">
        <!-- Form -->
        <section class="card p-6">
          <h2 class="text-lg font-semibold mb-4">Details</h2>
          <form id="inviteForm" class="space-y-4">
            <div class="grid grid-cols-1 md:grid-cols-2 gap-3">
              <label class="block">
                <span class="text-sm text-slate-600">Customer Name</span>
                <input name="name" required class="field mt-1 w-full rounded-lg text-slate-900 px-3 py-2 ring-1 ring-slate-200 focus:ring-2 focus:ring-slate-900 outline-none" placeholder="Jamie"/>
              </label>
              <label class="block">
                <span class="text-sm text-slate-600">Event</span>
                <input name="event" required class="field mt-1 w-full rounded-lg text-slate-900 px-3 py-2 ring-1 ring-slate-200 focus:ring-2 focus:ring-slate-900 outline-none" placeholder="Summer Try-On"/>
              </label>
            </div>

            <!-- ONE field each: type or choose (datalist) -->
            <div class="grid grid-cols-1 md:grid-cols-2 gap-3">
              <label class="block">
                <span class="text-sm text-slate-600">Tone (type or choose)</span>
                <input name="tone" list="toneList" class="field mt-1 w-full rounded-lg text-slate-900 px-3 py-2 ring-1 ring-slate-200 focus:ring-2 focus:ring-slate-900 outline-none" placeholder="Warm & Polished"/>
                <datalist id="toneList">
                  <option value="Warm & Polished"></option>
                  <option value="Playful & Fun"></option>
                  <option value="Elevated & Elegant"></option>
                  <option value="Casual & Friendly"></option>
                  <option value="Luxe Concierge"></option>
                  <option value="Minimal & Modern"></option>
                  <option value="Bold & Joyful"></option>
                  <option value="Romantic & Chic"></option>
                  <option value="Laid-Back & Conversational"></option>
                  <option value="VIP Personal Stylist"></option>
                </datalist>
              </label>

              <label class="block">
                <span class="text-sm text-slate-600">Collection (type or choose)</span>
                <input name="collection" list="collectionList" class="field mt-1 w-full rounded-lg text-slate-900 px-3 py-2 ring-1 ring-slate-200 focus:ring-2 focus:ring-slate-900 outline-none" placeholder="Summer Edit"/>
                <datalist id="collectionList">
                  <option value="Spring Edit"></option>
                  <option value="Summer Edit"></option>
                  <option value="Fall Edit"></option>
                  <option value="Holiday Edit"></option>
                  <option value="Just In"></option>
                  <option value="Everyday Essentials"></option>
                </datalist>
              </label>
            </div>

            <div class="grid grid-cols-1 md:grid-cols-2 gap-3">
              <label class="block">
                <span class="text-sm text-slate-600">Stylist Name</span>
                <input name="stylist" class="field mt-1 w-full rounded-lg text-slate-900 px-3 py-2 ring-1 ring-slate-200 focus:ring-2 focus:ring-slate-900 outline-none" placeholder="Your Cabi Stylist"/>
              </label>
              <label class="block">
                <span class="text-sm text-slate-600">Style Interests (optional)</span>
                <input name="style_interest" class="field mt-1 w-full rounded-lg text-slate-900 px-3 py-2 ring-1 ring-slate-200 focus:ring-2 focus:ring-slate-900 outline-none" placeholder="versatile pieces, polished essentials, week-to-weekend ease"/>
              </label>
            </div>

            <button class="w-full mt-2 rounded-xl bg-slate-900 hover:bg-slate-800 text-white font-medium px-4 py-3 transition">
              Generate Invitation
            </button>
          </form>
        </section>

        <!-- Output -->
        <section class="card p-6">
          <h2 class="text-lg font-semibold mb-4">Result</h2>
          <div id="status" class="text-sm text-slate-500 mb-3">Fill the form and click Generate.</div>
          <pre id="output" class="mono whitespace-pre-wrap bg-slate-50 rounded-lg p-4 min-h-[240px] ring-1 ring-slate-200"></pre>
          <div class="flex flex-wrap gap-3 mt-4">
            <button id="copyAll" class="rounded-lg bg-white hover:bg-slate-50 px-4 py-2 ring-1 ring-slate-200">Copy All</button>
            <button id="copySubject" class="rounded-lg bg-white hover:bg-slate-50 px-4 py-2 ring-1 ring-slate-200">Copy Subject</button>
            <button id="copyBody" class="rounded-lg bg-white hover:bg-slate-50 px-4 py-2 ring-1 ring-slate-200">Copy Body</button>
          </div>
        </section>
      </div>
    </div>
  </main>

  <footer class="max-w-5xl mx-auto px-4 md:px-6 pb-10 text-slate-500 text-sm">
    <p>Tip: Start typing to define your own tone or collection, or choose a suggestion.</p>
  </footer>

  <script>
    const FORM = document.getElementById('inviteForm');
    const OUT  = document.getElementById('output');
    const ST   = document.getElementById('status');

    // Replace with your Pipedream HTTP endpoint
    const ENDPOINT = "https://eocb0l4zskm1aad.m.pipedream.net";

    FORM.addEventListener('submit', async (e) => {
      e.preventDefault();
      ST.textContent = "Generatingâ€¦";
      OUT.textContent = "";
      const form = new FormData(FORM);
      const payload = Object.fromEntries(form.entries());

      try {
        const res = await fetch(ENDPOINT, {
          method: 'POST',
          headers: { 'Content-Type': 'application/json' },
          body: JSON.stringify(payload)
        });
        const data = await res.json();
        if (data.error) {
          ST.textContent = "Error";
          OUT.textContent = data.error;
        } else {
          ST.textContent = "Done";
          OUT.textContent = data.invitation || JSON.stringify(data, null, 2);
        }
      } catch (err) {
        ST.textContent = "Network error";
        OUT.textContent = String(err);
      }
    });

    function copy(text) {
      if (!text) return;
      navigator.clipboard.writeText(text).then(() => {
        ST.textContent = "Copied!";
        setTimeout(() => ST.textContent = "Ready", 900);
      });
    }

    document.getElementById('copyAll').onclick = () => copy(OUT.textContent || "");
    document.getElementById('copySubject').onclick = () => {
      const m = (OUT.textContent || "").match(/^Subject:\s*(.+)$/m);
      copy(m ? m[1] : "");
    };
    document.getElementById('copyBody').onclick = () => {
      const lines = (OUT.textContent || "").split("\n");
      const iStart = lines.findIndex(l => l.startsWith("Subject:")) + 2;
      copy(lines.slice(iStart, iStart + 4).join("\n"));
    };
  </script>
</body>
</html>
